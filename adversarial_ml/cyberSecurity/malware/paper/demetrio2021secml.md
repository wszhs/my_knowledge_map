# secml-malware: A Python Library for Adversarial Robustness Evaluation of Windows Malware Classifiers

## secml-malware: Architecture and Implementation

- White-boax attacks
 
|Proposed by|Practical manipulation|
|:-|:-:|
|Demetrio et al. (2019)|partial dos|
|Demetrio et al. (2020b)| full dos |
|Demetrio et al. (2020b)| extend |
| Demetrio et al. (2020b)| shift|
| Kolosnjaji et al. (2018)| padding|
| Kreuk et al. (2018) |slack+padding |
|Suciu et al. (2019) |slack+padding|

- Black-boax attacks

|Proposed by|Practical manipulation|
|:-|:-:|
|Demetrio et al. (2020a) |GAMMA padding |
|Demetrio et al. (2020a) |GAMMA section inj.|
|Demetrio et al. (2020b) |partial dos |
|Demetrio et al. (2020b) |full dos |
|Demetrio et al. (2020b) |extend |
|Demetrio et al. (2020b) |shift |
|Demetrio et al. (2020b) |padding |
|Demetrio et al. (2020b) |slack+padding|

This module contains all the attacking strategies, divided in whitebox and blackbox modules, and we provide a complete list of them in Table 1.

The attacks inside the whitebox sub-module are implemented by leveraging practical manipulations that address the perturbing of <font color="gree">single bytes inside the program</font> (Demetrio et al., 2019, 2020b; Kreuk et al., 2018; Suciu et al., 2019). 
These attacks exploit the ambiguity of the file format, by <font color="gree">filling unused space</font> inside the binary or <font color="gree">injecting new content</font> in particular positions, but always preserving the original functionality of the sample.

They span from byte-based to more <font color="gree">structural manipulations, e.g. section and API injection</font> (Demetrio et al. (2020a,b)). 
We also include GAMMA (Demetrio et al., 2020a), that is a black-box attack leveraging the <font color="gree">injection of benign content</font> to fool the target detector, by also keeping low the size of the adversarial malware and the number of queries sent.

## Application Example: Evaluating Adversarial Robustness of MalConv

- <font color="red">Partial DOS </font>: Proposed by Demetrio et al. (2019), this attack leverage the editing of a fraction of the <font color="gree">unused DOS header</font>, kept inside compiled binaries for retro-compatibility.
There are only two fields that must left untouched to not break the structure: the <font color="gree">magic number MZ at the beginning</font> of the file, and <font color="gree">the offset to the real header of the program</font>. All other bytes are freely editable by the attacker.

-  <font color="red">Extend</font>: Proposed by Demetrio et al. (2020b), this attack leverage the  <font color="gree">extension of the unused DOS header</font>, by shifting the real one by a custom amount, and injecting adversarial content there. Intuitively, the manipulation exploits the presence of an offset inside the DOS header, that instructs the loader where the real header of the program is placed inside the binary. The injected content must be compliant with the constraints imposed by the file format, e.g. the file alignment specified in the header.

- <font color="red">Shift</font>: Proposed by Demetrio et al. (2020b), this attack <font color="gree">inject new content</font> before the first section, by shifting all the content by the custom amount. This manipulation exploits the offsets inside the header of the program that instructs the loader where the sections start inside the binary. Since all sections must be aligned to a multiple of the file alignment, the content must match this constraint in order to not break the structure.

- <font color="red">Padding</font>: Proposed by Kolosnjaji et al. (2018), this attack leverages the <font color="gree">appending of new bytes at the end of the executable</font>. Such content is not controlled by the loader, since there are no pointers to such addition inside neither the code and the header. No constraints must be applied on this manipulation.

- <font color="red">GAMMA-padding</font>: Proposed by Demetrio et al. (2020a), this attack leverage the <font color="gree">padding practical manipulation to inject content </font> extracted from benign software (i.e. goodware programs). It relies on a regularization parameter to control the size of the injected content, so the adversarial EXEmples do not grow unbounded.